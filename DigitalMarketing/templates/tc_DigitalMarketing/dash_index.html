{% extends 'tc_DigitalMarketing/dashboardbase.html' %}
{% load static %}

{% block content %}
<style>
    [data-initials]:before {
    background: #099bdd;
    color: white;
    opacity: 1; 
    content: attr(data-initials); 
    display: inline-block; 
    font-weight: bold; 
    border-radius: 50%; 
    vertical-align: middle; 
    margin-right: 0.5em; 
    width: 50px; 
    height: 50px; 
    line-height: 50px; 
    text-align: center; 
    }
    </style>
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <a class="navbar-brand d-inline-flex align-items-center" href="/dm/uploaderdashboard/{{ id }}">
                <!-- <img src="{% static 'images/logo_icon.png'%}" alt="" class="img-fluid"> -->
              <h2>true<span>coverage</span></h2>
          </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto align-items-center">
              <!-- <li class="nav-item">
                <a class="nav-link" aria-current="page" href="#"><i class="bi bi-moon"></i></a>
              </li>
              <li class="nav-item">
                <a class="nav-link active" href="#">
                    <i class="bi bi-brightness-high"></i>
                </a>
              </li> -->
              <li class="nav-item">
                <a class="nav-link" href="#">
                    <i class="bi bi-bell"></i>
                </a>
              </li>
              <!-- <li class="nav-item account-section" id="accountSection" onclick="myFunction()">
                <a class="nav-link" href="#">
                  <span>My Account</span>
                  <span class="av-holder">
                    <img src="{% static 'images/avatar.png'%}" alt="">
                    <i class="bi bi-chevron-down"></i>
                  </span>
                </a>
              </li> -->

              <li class="nav-item account-section" id="accountSection" onclick="myFunction()">
                <a class="nav-link" href="#">
                  <span>My Account</span>
                  <span class="av-holder">
                    <!-- <img src={{userdetails.profile_pic}} alt=""/> -->
                    <span data-initials="{{userdetails.username.0|title}}"></span>
                    <i class="bi bi-chevron-down"></i>
                  </span>
                </a>
                <div class="dropdown-panel">
                  <ul>
                    <a style="text-decoration: none;color: inherit;" href="/dm/account/{{ id }}" rel="noopener noreferrer"><li >Account</li> </a>
                      <a style="text-decoration: none;color: inherit;" href="{% url 'logout'%}" rel="noopener noreferrer"><li>Logout</li></a>
                  </ul>
                </div>
              </li>

            </ul>
          </div>
        </div>
      </nav> 
      {% include 'tc_DigitalMarketing/messages.html' %}
      <!-- <div class="messege">
      </div> -->
      <div class="inner-areas container-fluid">
            <div class="row mt-3 mb-3">
                <div class="col-md-3">
                    <div class="row">
                        <div class="col-12 col-md-12 col-lg-12">
                            <div class="welcome-box d-flex">
                                <div class="left-contents">
                                    <h3>Congratulations {{UserName}}!</h3>
                                <p>Approved Assets level go up</p>
                                <h2>{{ Approved }}</h2>
                                <a style="text-decoration: none;color: inherit;"href='/dm/detailedview/{{ id }}' rel="noopener noreferrer"><button class="view-btn btn btn-primary">View Detailed Report</button></a>
                                </div>
                                <div class="image-man">
                                    <img src="{% static 'images/user_welcome.png'%}" alt=""> 
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-9">
                    <div class="row">
                        <div class="col-12 col-md-3 col-lg-3">
                            <div class="info-box approved justify-content-between align-items-center">
                                <a style="text-decoration: none;color: inherit;" href='/dm/filterpage/{{ id }}/Approved/User' rel="noopener noreferrer">
                                <div class="left-box">
                                    <h4>Approved Assets</h4>
                                    <h2>{{ Approved }}</h2>
                                    <div class="mini-info">
                                        <i class="bi bi-arrow-up"></i><span>0%</span> This month
                                    </div>
                                </div>
                                </a>
                                <a style="text-decoration: none;color: inherit;" href='/dm/filterpage/{{ id }}/Approved/User' rel="noopener noreferrer">
                                <div class="right-box">
                                    <div class="icon-holder">
                                        <img src="{% static 'images/video_icon.svg'%}" alt="">
                                    </div>
                                </div>
                                </a>
                            </div>
                        </div>
                        <div class="col-12 col-md-3 col-lg-3">
                            <div class="info-box rejected justify-content-between  align-items-center">
                                <a style="text-decoration: none;color: inherit;" href='/dm/filterpage/{{ id }}/Rejected/User' rel="noopener noreferrer">
                                <div class="left-box">
                                    <h4>Rejected Assets</h4>
                                    <h2>{{ Rejected }}</h2>
                                    <div class="mini-info">
                                        <i class="bi bi-arrow-down"></i><span>0%</span> This month
                                    </div>
                                </div>
                                </a>
                                <a style="text-decoration: none;color: inherit;" href='/dm/filterpage/{{ id }}/Rejected/User' rel="noopener noreferrer">
                                <div class="right-box">
                                    <div class="icon-holder">
                                        <img src="{% static 'images/video_icon.svg'%}" alt="">
                                    </div>
                                </div>
                                </a>
                            </div>
                        </div>
                        <div class="col-12 col-md-3 col-lg-3">
                            <div class="info-box pending justify-content-between  align-items-center">
                                <a style="text-decoration: none;color: inherit;" href='/dm/filterpage/{{ id }}/Pending/User' rel="noopener noreferrer">
                                <div class="left-box">
                                    <h4>Pending Assets</h4>
                                    <h2>{{ Pending }}</h2>
                                    <div class="mini-info">
                                        <i class="bi bi-arrow-down"></i><span>0%</span> This month
                                    </div>
                                </div>
                                </a>
                                <a style="text-decoration: none;color: inherit;" href='/dm/filterpage/{{ id }}/Pending/User' rel="noopener noreferrer">
                                <div class="right-box">
                                    <div class="icon-holder">
                                        <img src="{% static 'images/video_icon.svg'%}" alt="">
                                    </div>
                                </div>
                                </a>
                            </div>
                        </div>
                        <div class="col-12 col-md-3 col-lg-3">
                            <a style="text-decoration: none" href='/dm/uploadfile/{{ id }}' rel="noopener noreferrer">
                            <button class="upload-section" >
                                <div class="upload-inner d-flex flex-column">
                                    <i class="bi bi-upload"></i>
                                <span>Video / Images / Gif</span>
                                </div>
                            </button>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-5 col-12">
                     <div class="row">
                        <div class="col-12 col-md-6">
                            <a style="text-decoration: none;color: inherit;" href='/dm/myvideos/{{ id }}' rel="noopener noreferrer">
                            <div class="white-box">
                                 <div class="my-heads">
                                    <h4>My Assets</h4>
                                 </div>
                                 <img src="{% static 'images/player.png'%}" alt="" class="img-fluid playerimg">
                                 <div class="shapes">
                                    <img src="{% static 'images/shape.svg'%}" alt="" class="img-fluid">
                                    <img src="{% static 'images/shape_2.svg'%}" alt="" class="img-fluid">
                                 </div>
                            </div>
                            </a>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="white-box">
                                <div class="my-heads">
                                    <h4>Uploaded File types</h4>
                                 </div>
                                 <div id="barChart"></div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="white-box">
                                <div class="my-heads">
                                    <h4>Reviewers <a class="show" href="#">Show All</a></h4>
                                 </div>
                                 <div class="av-list d-flex">
                                        {% for i in admin_approver %}
                                        <!-- <a href="/dm/account/{{i.userid}}">
                                            <img src={{i.profile_pic}} alt="" style="border-radius: 50%;"> 
                                        </a> -->
                                        <a href="/dm/account/{{i.userid}}">
                                            <div data-initials="{{i.username.0|title}}"></div>
                                        </a>
                                        {% endfor %}
                                 </div>
                            </div>
                        </div>
                     </div>
                </div>
                <div class="col-md-7 col-12">
                    <div class="row">
                        <div class="col-md-5">
                           <div class="white-box mb-3">
                                <h4>Uploaded Images</h4>
                                <div class="d-flex img-show align-items-center">
                                    <div class="img-block-left">
                                        <img src="{% static 'images/img.svg'%}" alt="">
                                    </div>
                                    <div class="img-right-block">
                                        <h2>{{upload_img_gif_count}}</h2>
                                        <div class="mini-info">
                                            <i class="bi bi-arrow-up"></i><span>0%</span> This month
                                        </div>
                                    </div>
                                </div>
                           </div>
                           <div class="white-box tasks-holder" style="overflow-y: scroll; height: 280px;">
                                <h4>Recent</h4>
                                <table class="table table-stripped">
                                    <tbody style="overflow-y: scroll; height: 100px;">
                                    {% for i in recent %}
                                    <tr>
                                    <div class="alert-lists mt-2">
                                            <td style="word-break: break-all;  overflow-y: auto;">
                                                <div class="info-list success" style="overflow-y: scroll; height: 33px;">
                                                <i class="bi bi-play-circle"></i>
                                                {{i.videoname}}
                                                </div>
                                            </td>
        
                                            <td>
                                                <div class="info-list success">
                                                    <!-- {% if i.status != 'Rejected' %}
                                                    ---
                                                    {% endif %}
                                                    {% if i.status == 'Rejected' %}
                                                    <a style="text-decoration:none" href="/dm/statusview/{{i.videoid}}/{{id}}"> View  </a>
                                                    {% endif %} -->
                                                    {% if i.status == 'Pending' %}
                                                    <a style="text-decoration:none" href="/dm/updateview/{{id}}/{{i.videoid}}"> View </a>
                                                    {% endif %}
                                                    {% if i.status == 'Approved' %}
                                                    <a style="text-decoration:none" href="/dm/statusview/{{i.videoid}}/{{id}}"> View </a>
                                                    {% endif %}
                                                    {% if i.status == 'Rejected' %}
                                                    <a style="text-decoration:none" href="/dm/statusview/{{i.videoid}}/{{id}}"> View </a>
                                                    {% endif %}
                                                </div>
                                            </td>
        
                                        </div>
                                    </div>                     
                                </tr>
                                    {% endfor %}
                                </tbody>
                            </table>

                           </div>
                        </div>
                        <div class="col-md-7">
                            <div class="white-box">
                                <h4>Upload History</h4>
                                <div id="uploadHistory">
                                    
                                </div>
                            </div>
                        </div>
                    </div>
               </div>
            </div>
            <!-- <div class="row">
                <div class="col-12">
                    <div class="white-box table-container">
                        <h2>Uploaded  Videos</h2>
                         <table class="table table-stripped">
                            <thead>
                                <tr>
                                    <th>Sl No.</th>
                                    <th>Video Title</th>
                                    <th>Upload Date & Time</th>
                                    <th>Status</th>
                                    <th>Reason</th>
                                    <th>Reviewer Name</th>                                    
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>10 Awesome Ways to Catch a Fish Without a Rod</td>
                                    <td>June 1, 2023, 10:23pm</td>
                                    <td>
                                        <span class="tag pending">
                                            Pending
                                        </span>
                                    </td>
                                    <td>
                                        Upload quality is not good
                                    </td>
                                    <td>
                                        <span class="upload-info">
                                            <img src="images/av_5.png" alt="">
                                            Chandra 
                                        </span>
                                    </td>
                                  
                                </tr>
                                <tr>
                                    <td>1</td>
                                    <td>10 Awesome Ways to Catch a Fish Without a Rod</td>
                                    <td>June 1, 2023, 10:23pm</td>
                                    <td>
                                        <span class="tag pending">
                                            Pending
                                        </span>
                                    </td>
                                    <td>
                                        Upload quality is not good
                                    </td>
                                    <td>
                                        <span class="upload-info">
                                            <img src="images/av_5.png" alt="">
                                            Chandra 
                                        </span>
                                    </td>
                                  
                                </tr>
                                <tr>
                                    <td>1</td>
                                    <td>10 Awesome Ways to Catch a Fish Without a Rod</td>
                                    <td>June 1, 2023, 10:23pm</td>
                                    <td>
                                        <span class="tag pending">
                                            Pending
                                        </span>
                                    </td>
                                    <td>
                                        Upload quality is not good
                                    </td>
                                    <td>
                                        <span class="upload-info">
                                            <img src="images/av_5.png" alt="">
                                            Chandra 
                                        </span>
                                    </td>
                                  
                                </tr>
                            </tbody>
                         </table>
                    </div>
                </div>
            </div> -->
            <div class="row">
                <div class="col-12">
                    <div class="white-box table-container">
                        <h2>Uploaded  Videos</h2>
                        <div class="overflow-auto" style="max-width:100%; max-height:30vh"> 
                         <table class="table table-stripped" id="videotable">
                            <thead>
                                <tr>
                                    <!-- <th>Sl No.</th> -->
                                    <th>Video Title</th>
                                    <th>Date & Time
                                        <img src="{% static 'images/sort.png'%}" onclick="sortTable(1)" style="height:20px; width:20px">
                                    </th>
                                    <th>Uploaded By
                                        <input type="text" id="myinput" onkeyup="searchName" placeholder="Search" style="width:70px; height:25px; border-radius:5px;  border: none;">
                                    </th>
                                    <th>Status
                                        {% comment %} <input type="text" id="mystatus" onkeyup="searchStatus" placeholder="Search" style="width:70px; height:25px; border-radius:5px;  border-width: 1px;"> {% endcomment %}
                                        <select id="statusFilter" onchange="filterStatus()" style="width:90px; height:25px; border-radius:5px;  border: none;">
                                            <option value="All">All</option>
                                            <option value="Approved">Approved</option>
                                            <option value="Pending">Pending</option>
                                            <option value="Rejected">Rejected</option>
                                          </select>
                                    </th>
                                    <th>Video Details</th>
                                    <th>Reviewer Name</th>                                    
                                </tr>
                            </thead>
                            <tbody>
                                {% for i in status %}
                                <tr>
                                    <!-- <td>#</td> -->
                                    <td>{{i.videoname}}</td>
                                    <td>{{i.createddate}}</td>
                                    <td>{{i.uploadername}}</td>
                                    <td>
                                        <span class="tag pending">
                                            {{i.status}}
                                        </span>
                                    </td>
                                    <td>
                                        {% if i.status == 'Pending' %}
                                        <a style="text-decoration:none" href="/dm/updateview/{{id}}/{{i.videoid}}"> View </a>
                                        {% endif %}
                                        {% if i.status == 'Approved' %}
                                        <a style="text-decoration:none" href="/dm/statusview/{{i.videoid}}/{{id}}"> View </a>
                                        {% endif %}
                                        {% if i.status == 'Rejected' %}
                                        <a style="text-decoration:none" href="/dm/statusview/{{i.videoid}}/{{id}}"> View </a>
                                        {% endif %}
                                    </td>
                                    <td>
                                        <span class="upload-info">
                                            {% if i.approver == '---' %}
                                            Waiting for Review
                                            {% endif %}
                                            {% if i.approver != '---' %}
                                            <!-- <img src="{% static 'images/av_5.png'%}" alt=""> -->
                                            {{i.approver}} 
                                            {% endif %}
                                        </span>
                                    </td>
                                  
                                </tr>
                                {% endfor %}
                            </tbody>
                         </table>
                    </div>
                    </div>
                </div>
            </div> 
      </div>





      <script language="javascript">

        function sortTable(n) {
            var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
            table = document.getElementById("videotable");
            switching = true;
            dir = "asc"; 
            while (switching) {
              switching = false;
              rows = table.rows;
              for (i = 1; i < (rows.length - 1); i++) {
                shouldSwitch = false;
                x = rows[i].getElementsByTagName("TD")[n];
                y = rows[i + 1].getElementsByTagName("TD")[n];
                if (dir == "asc") {
                  if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                    shouldSwitch= true;
                    break;
                  }
                } else if (dir == "desc") {
                  if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                    shouldSwitch = true;
                    break;
                  }
                }
              }
                if (shouldSwitch) {
                    rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                    switching = true;
                    switchcount ++;      
                } else {
                    if (switchcount == 0 && dir == "asc") {
                        dir = "desc";
                        switching = true;
                }
              }
            }
          }
    </script>

    <script language="javascript">
        document.getElementById('myinput').addEventListener('keyup', searchName);
        function searchName() {
            var input, filter, table, tr, td, i, txtValue;
            input = document.getElementById("myinput");
            filter = input.value.toUpperCase();
            table = document.getElementById("videotable");
            tr = table.getElementsByTagName("tr");

            for (i = 0; i < tr.length; i++) {
                td = tr[i].getElementsByTagName("td")[2]; // Change this to the index of the column you want to filter
                if (td) {
                    txtValue = td.textContent || td.innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
            }
        }       
    }
}
</script>

<script language="javascript">
    document.getElementById('mystatus').addEventListener('keyup', searchStatus);
    function searchStatus() {
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById("mystatus");
        filter = input.value.toUpperCase();
        table = document.getElementById("videotable");
        tr = table.getElementsByTagName("tr");

        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td")[3]; // Change this to the index of the column you want to filter
            if (td) {
                txtValue = td.textContent || td.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                } else {
                    tr[i].style.display = "none";
        }
    }       
}
}
</script>

<script>
    function filterStatus(){
        var dropdown = document.getElementById("statusFilter");
        var selectedValue = dropdown.value;
        var table = document.getElementById("videotable");
        var rows = table.getElementsByTagName("tr");
    
        for (var i=1;i<rows.length;i++){
            var row = rows[i];
            var status = row.cells[3].textContent.trim();
    
            if (selectedValue === "All" || status === selectedValue)
            {
                row.style.display = '';
            }
            else{
                row.style.display = "none";
            }
        }
    }
    </script>
    
{% endblock content %}
      

